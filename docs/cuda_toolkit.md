# Return to install.md

[install.md](../install/install.md)

# Instructions for Downloading and Installing CUDA Toolkit 12.1 or 12.4 on Ubuntu 20.04

If you have never installed the CUDA Toolkit from NVIDIA, you will have a much easier time following the sequence of steps laid out in this file. 

This guide assumes you are using Ubuntu 20.04 (though the 18.04 and 22.04 guides are quite similar), and that your **Installer Type** is `deb (local)` for the CUDA Toolkit. This guide also assumes you have NVIDIA drivers installed already (hint execute `nvidia-smi`) and have no other version of the CUDA Toolkit installed on your system. If you have another version installed, please see the `Handle conflicting installation methods` section for [CUDA 12.1](https://docs.nvidia.com/cuda/archive/12.1.1/cuda-installation-guide-linux/index.html#handle-conflicting-installation-methods) or [CUDA 12.4](https://docs.nvidia.com/cuda/archive/12.4.1/cuda-installation-guide-linux/index.html#handle-conflicting-installation-methods), or configure multiple installations on your own.

## Overview

1. Perform Pre-installation Actions
2. Download and Install the correct NVIDIA CUDA Toolkit
3. Perform Post-installation Actions

## Step 1 - Perform Pre-installation Actions

- Verify the system has a CUDA-capable GPU.
- Verify the system is running a supported version of Linux.
- Verify the system has gcc installed.
- Verify the system has the correct kernel headers and development packages installed.

### Verify the system has a CUDA-capable GPU

The following command should return settings, indicating your NVIDIA GPU is CUDA capable. Typically, there will be a line for each GPU set up for your system.
```
lspci | grep -i nvidia
```

### Verify the system is running a supported version of Linux

The following command should return your Linux Distribution.
```
uname -m && cat /etc/*release
```

### Verify the system has gcc installed

The following command should return the GCC version you have installed:
```
gcc --version
```

### Verify the system ha the correct kernel headers and development packages installed

The following command tells you the version of the kernel your system is running:
```
uname -r
```

The following command installs the kernel headers and development packages for the currently running kernel:
```
sudo apt-get install linux-headers-$(uname -r)
```

## Step 2 - Download and Install the correct NVIDIA CUDA Toolkit

- Navigate to the relevant CUDA Toolkit Download site
- Fill out the settings that prompt your download commands
- Execute the commands detailed here

### Navigate to the relevant CUDA Toolkit Download site

For CUDA 12.1, navigate to https://developer.nvidia.com/cuda-12-1-1-download-archive

For CUDA 12. 4, navigate to https://developer.nvidia.com/cuda-12-4-1-download-archive

### Fill out the settings that prompt your download commands

For example, Ubuntu 20.04 local debian install with a 64-bit system:
- Operating System: Linux
- Architecture: x86_64
- Distribution: Ubuntu
- Version: 20.04
- Installer Type: deb (local)

### Execute the commands detailed here

**NOTE: Do NOT install the CUDA Toolkit yet, this happens in the next step**

- For **CUDA 12.1**, ensure the following commands match the commands generated by the settings from the previous step in NVIDIA's CUDA Toolkit Download Archives (with exception to the `sudo apt install` command):
  ```
  wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/cuda-ubuntu2004.pin
  ```
  ```
  sudo mv cuda-ubuntu2004.pin /etc/apt/preferences.d/cuda-repository-pin-600
  ```
  ```
  wget https://developer.download.nvidia.com/compute/cuda/12.1.1/local_installers/cuda-repo-ubuntu2004-12-1-local_12.1.1-530.30.02-1_amd64.deb
  ```
  ```
  sudo dpkg -i cuda-repo-ubuntu2004-12-1-local_12.1.1-530.30.02-1_amd64.deb
  ```
  ```
  sudo cp /var/cuda-repo-ubuntu2004-12-1-local/cuda-*-keyring.gpg /usr/share/keyrings/
  ```
  ```
  sudo apt-get update
  ```
  ```
  sudo apt-get -y install cuda-toolkit-12-1
  ```
  ```
  sudo reboot
  ```

- For **CUDA 12.4**, ensure the following commands match the commands generated by the settings from the previous step in NVIDIA's CUDA Toolkit Download Archives (with exception to the `sudo apt install` command):
  ```
  wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/cuda-ubuntu2004.pin
  ```
  ```
  sudo mv cuda-ubuntu2004.pin /etc/apt/preferences.d/cuda-repository-pin-600
  ```
  ```
  wget https://developer.download.nvidia.com/compute/cuda/12.4.1/local_installers/cuda-repo-ubuntu2004-12-4-local_12.4.1-550.54.15-1_amd64.deb
  ```
  ```
  sudo dpkg -i cuda-repo-ubuntu2004-12-4-local_12.4.1-550.54.15-1_amd64.deb
  ```
  ```
  sudo cp /var/cuda-repo-ubuntu2004-12-4-local/cuda-*-keyring.gpg /usr/share/keyrings/
  ```
  ```
  sudo apt-get update
  ```
  ```
  sudo apt-get -y install cuda-toolkit-12-4
  ```
  ```
  sudo reboot
  ```

## Step 3 - Perform Post-installation Actions

The `PATH` variable needs to include `/usr/local/cuda-12.0/bin${PATH:+:${PATH}}`. To ensure this, execute:
```
export PATH=/usr/local/cuda-12.0/bin${PATH:+:${PATH}}
```

